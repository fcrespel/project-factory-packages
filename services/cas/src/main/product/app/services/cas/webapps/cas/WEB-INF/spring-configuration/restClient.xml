<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

	<bean id="restTrustStore" class="org.springframework.ws.soap.security.support.KeyStoreFactoryBean">
		<property name="location" value="${cas.rest.auth.ssl.trustStore}" />
	</bean>
	
	<bean id="restPlainSocketFactory" class="org.apache.http.conn.scheme.PlainSocketFactory" />
	
	<bean id="restSslSocketFactory" class="org.apache.http.conn.ssl.SSLSocketFactory">
		<constructor-arg index="0" ref="restTrustStore" />
		<property name="hostnameVerifier">
			<bean class="org.apache.http.conn.ssl.AllowAllHostnameVerifier" />
		</property>
	</bean>
	
	<bean id="restSchemeRegistry" class="org.apache.http.conn.scheme.SchemeRegistry">
		<property name="items">
			<map>
				<entry>
					<key><value>http</value></key>
					<bean class="org.apache.http.conn.scheme.Scheme">
						<constructor-arg index="0" value="http" />
						<constructor-arg index="1" value="80" />
						<constructor-arg index="2" ref="restPlainSocketFactory" />
					</bean>
				</entry>
				<entry>
					<key><value>https</value></key>
					<bean class="org.apache.http.conn.scheme.Scheme">
						<constructor-arg index="0" value="https" />
						<constructor-arg index="1" value="443" />
						<constructor-arg index="2" ref="restSslSocketFactory" />
					</bean>
				</entry>
			</map>
		</property>
	</bean>
	
	<bean id="restConnectionManager" class="org.apache.http.impl.conn.tsccm.ThreadSafeClientConnManager">
		<constructor-arg index="0" ref="restSchemeRegistry" />
		<property name="defaultMaxPerRoute" value="5" />
		<property name="maxTotal" value="100" />
	</bean>
	
	<bean id="restHttpClient" class="org.apache.http.impl.client.DefaultHttpClient">
		<constructor-arg index="0" ref="restConnectionManager" />
	</bean>
	
	<bean id="restRequestFactory" class="org.springframework.http.client.HttpComponentsClientHttpRequestFactory">
		<property name="httpClient" ref="restHttpClient" />
		<property name="connectTimeout" value="${cas.rest.auth.connectTimeout}" />
		<property name="readTimeout" value="${cas.rest.auth.readTimeout}" />
	</bean>

	<bean id="restTemplate" class="org.springframework.web.client.RestTemplate">
		<property name="requestFactory" ref="restRequestFactory" />
	</bean>

</beans>
