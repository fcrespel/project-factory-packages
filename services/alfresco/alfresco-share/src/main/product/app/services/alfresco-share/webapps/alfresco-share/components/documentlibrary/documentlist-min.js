(function(){var A=YAHOO.util.Dom,P=YAHOO.util.Event,N=YAHOO.util.DragDropMgr;var f=Alfresco.util.encodeHTML,al=Alfresco.util.activateLinks,aK=Alfresco.util.combinePaths,n=Alfresco.util.userProfileLink,b=Alfresco.util.siteURL,O=function O(a4,a5){return Alfresco.util.formatDate(Alfresco.util.fromISO8601(a4),a5)},ac=Alfresco.util.relativeTime,F=Alfresco.util.isValueSet;var aV="org.alfresco.share.documentList",aG=aV+".sortAscending",d=aV+".sortField",Z=aV+".showFolders",E=aV+".hideNavBar",T=aV+".simpleView",aa=aV+".viewRendererName",av=aV+".galleryColumns";if(!String.prototype.startsWith){String.prototype.startsWith=function(a5,a4){a4=a4||0;return this.substr(a4,a5.length)===a5}}Alfresco.DnD=function(a8,a5,a4,a6){Alfresco.DnD.superclass.constructor.call(this,a8,a4,a6);var a7=this.getDragEl();A.setStyle(a7,"opacity",0.67);this.docLib=a5};YAHOO.extend(Alfresco.DnD,YAHOO.util.DDProxy,{_inFlight:false,startDrag:function p(a5,a8){var a4=this.getDragEl();var a7=this.getEl();A.setStyle(a7,"visibility","hidden");var a6=document.createElement("img");a6.src=a7.src;a4.removeChild(a4.firstChild);a4.appendChild(a6);A.setStyle(a4,"border","none")},endDrag:function aj(a6){if(!this._inFlight){var a4=this.getEl();var a5=this.getDragEl();this.animateResult(a5,a4)}},animateResult:function ar(a7,a4){A.setStyle(a7,"visibility","");var a5=new YAHOO.util.Motion(a7,{points:{to:A.getXY(a4)}},0.2,YAHOO.util.Easing.easeOut);var a6=a7.id;var a8=this.id;a5.onComplete.subscribe(function(){A.setStyle(a6,"visibility","hidden");A.setStyle(a8,"visibility","")});a5.animate()},onDragDrop:function t(a9,a6){var a4=A.get(a6);if(N.interactionInfo.drop.length>0){if(A.isAncestor(this.docLib.widgets.dataTable.getContainerEl(),a4)){var a5=this.docLib.widgets.dataTable.getRecord(A.get(a6)),ba=a5.getData();if(ba.node.isContainer){this._inFlight=true;var bc;if(ba.node.isLink){bc=new Alfresco.util.NodeRef(ba.node.linkedNode.nodeRef)}else{bc=new Alfresco.util.NodeRef(ba.node.nodeRef)}this._performMove(bc,ba.location.path+"/"+ba.location.file)}}else{if(A.hasClass(a4,"documentDroppable")){var a7=A.get("alf-filters"),a8=(a7?parseInt(a7.style.width,10):160);if(a9.clientX>a8){}else{var bb={elementId:a6,callback:this.onDropTargetOwnerCallBack,scope:this};YAHOO.Bubbling.fire("dropTargetOwnerRequest",bb)}this._inFlight=true;this._setFailureTimeout()}}}},_performMove:function aq(a9,bc){var a6=this.docLib.widgets.dataTable.getRecord(this.getEl()),a7="move-to/node/{nodeRef}",bb=[];bb.push(this.getEl().id);var ba=function a8(bf){this._inFlight=false;var bd,bg=bf.json.successCount,bh=bf.json.failureCount;if(!bf.json.overallSuccess){this.animateResult(this.getDragEl(),this.getEl());Alfresco.util.PopupManager.displayMessage({text:this.docLib.msg("message.file-dnd-move.failure")});A.removeClass(this.dragFolderHighlight,"dndFolderHighlight");return}this.docLib._updateDocList.call(this.docLib);var be=a6.getData();if(be.node.isContainer){YAHOO.Bubbling.fire("folderMoved",{multiple:true,nodeRef:be.nodeRef,destination:bc})}};var a5=function a4(bd){this._inFlight=false;this.animateResult(this.getDragEl(),this.getEl());Alfresco.util.PopupManager.displayMessage({text:this.docLib.msg("message.file-dnd-move.failure")});A.removeClass(this.dragFolderHighlight,"dndFolderHighlight")};this.docLib.modules.actions.genericAction({success:{callback:{fn:ba,scope:this}},failure:{callback:{fn:a5,scope:this}},webscript:{method:Alfresco.util.Ajax.POST,name:a7,params:{nodeRef:a9.uri}},wait:{message:this.docLib.msg("message.please-wait")},config:{requestContentType:Alfresco.util.Ajax.JSON,dataObj:{nodeRefs:bb,parentId:this.docLib.doclistMetadata.parent.nodeRef}}})},_currTimeoutId:null,onDropTargetOwnerCallBack:function aw(a4,a6){this._clearTimeout();var a5=new Alfresco.util.NodeRef(a4);this._performMove(a5,a6)},_clearTimeout:function ak(){if(this._currTimeoutId!=null){window.clearTimeout(this._currTimeoutId);this._currTimeoutId=null;this._inFlight=false}},_setFailureTimeout:function aN(){this._clearTimeout();var a4=this;this._currTimeoutId=window.setTimeout(function(){a4.animateResult(a4.getDragEl(),a4.getEl());a4._inFlight=false;a4._currTimeoutId=null},500)},onDragOver:function aZ(a6,a7){var a4=A.get(a7);if(a4.tagName=="IMG"||a4.className=="droppable"){this.dragFolderHighlight=A.getAncestorByClassName(a4,"folder");A.addClass(this.dragFolderHighlight,"dndFolderHighlight")}else{if(A.hasClass(a4,"documentDroppableHighlights")){var a5={elementId:a7,event:a6};YAHOO.Bubbling.fire("documentDragOver",a5)}}},onDragOut:function aO(a6,a7){var a4=A.get(a7);if(a4.tagName=="IMG"||a4.className=="droppable"){this.dragFolderHighlight=A.getAncestorByClassName(a4,"folder");A.removeClass(this.dragFolderHighlight,"dndFolderHighlight")}else{if(A.hasClass(a4,"documentDroppableHighlights")){var a5={elementId:a7,event:a6};YAHOO.Bubbling.fire("documentDragOut",a5)}}}});Alfresco.DocumentList=function(a4){Alfresco.DocumentList.superclass.constructor.call(this,"Alfresco.DocumentList",a4,["button","menu","container","datasource","datatable","paginator","json","history"]);this.currentPath="";this.currentPage=1;this.totalRecords=0;this.totalRecordsUpper=null;this.hideMoreActionsFn=null;this.state={actionEditOfflineActive:false};this.currentFilter={filterId:"path",filterData:""};this.actions={};this.selectedFiles={};this.afterDocListUpdate=[];this.doclistMetadata={};this.previewTooltips=[];this.insituEditors=[];this.dynamicControls=[];this.sortControls=[];this.dragAndDropAllowed=true;this.dragAndDropEnabled=false;this.dragEventRefCount=0;this.actionsView="browse";this.renderers={};this.viewRenderers={};this.dataSourceUrl=aK(Alfresco.constants.URL_SERVICECONTEXT,"components/documentlibrary/data/doclist/");YAHOO.Bubbling.on("activateDynamicControls",this.onActivateDynamicControls,this);YAHOO.Bubbling.on("activateSortControls",this.onActivateSortControls,this);YAHOO.Bubbling.on("deactivateAllControls",this.onDeactivateAllControls,this);YAHOO.Bubbling.on("deactivateDynamicControls",this.onDeactivateDynamicControls,this);YAHOO.Bubbling.on("deactivateSortControls",this.onDeactivateSortControls,this);YAHOO.Bubbling.on("metadataRefresh",this.onDocListRefresh,this);YAHOO.Bubbling.on("fileRenamed",this.onFileRenamed,this);YAHOO.Bubbling.on("changeFilter",this.onChangeFilter,this);YAHOO.Bubbling.on("filterChanged",this.onFilterChanged,this);YAHOO.Bubbling.on("folderCreated",this.onDocListRefresh,this);YAHOO.Bubbling.on("nodeCreated",this.onDocListRefresh,this);YAHOO.Bubbling.on("folderRenamed",this.onFileRenamed,this);YAHOO.Bubbling.on("highlightFile",this.onHighlightFile,this);YAHOO.Bubbling.on("registerRenderer",this.onRegisterRenderer,this);YAHOO.Bubbling.on("registerViewRenderer",this.onRegisterViewRenderer,this);YAHOO.Bubbling.on("registerAction",this.onRegisterAction,this);YAHOO.Bubbling.on("resizerChanged",this.onResizerChanged,this);YAHOO.Bubbling.on("fileCopied",this.onFileAction,this);YAHOO.Bubbling.on("fileDeleted",this.onFileAction,this);YAHOO.Bubbling.on("fileMoved",this.onFileAction,this);YAHOO.Bubbling.on("filePermissionsUpdated",this.onFileAction,this);YAHOO.Bubbling.on("folderCopied",this.onFileAction,this);YAHOO.Bubbling.on("folderDeleted",this.onFileAction,this);YAHOO.Bubbling.on("folderMoved",this.onFileAction,this);YAHOO.Bubbling.on("folderPermissionsUpdated",this.onFileAction,this);YAHOO.Bubbling.on("filesCopied",this.onDocListRefresh,this);YAHOO.Bubbling.on("filesDeleted",this.onDocListRefresh,this);YAHOO.Bubbling.on("filesMoved",this.onDocListRefresh,this);YAHOO.Bubbling.on("filesPermissionsUpdated",this.onDocListRefresh,this);return this};YAHOO.extend(Alfresco.DocumentList,Alfresco.component.Base);YAHOO.lang.augmentProto(Alfresco.DocumentList,Alfresco.doclib.Actions);Alfresco.DocumentList.generateFilterMarkup=function v(a4){var a5=Alfresco.util.cleanBubblingObject(a4);return YAHOO.lang.substitute("{filterOwner}|{filterId}|{filterData}|{filterDisplay}",a5,function(a7,a8,a6){return typeof a8==="undefined"?"":window.escape(a8)})};Alfresco.DocumentList.generatePathMarkup=function am(a4){return Alfresco.DocumentList.generateFilterMarkup({filterId:"path",filterData:aK(a4.path,a4.file)})};Alfresco.DocumentList.generateCategoryMarkup=function k(a4){return Alfresco.DocumentList.generateFilterMarkup({filterId:"category",filterData:aK(a4[1],a4[0])})};Alfresco.DocumentList.generateFileFolderLinkMarkup=function h(bb,a7){var a4=a7.jsNode,a6;if(a4.isLink&&F(bb.options.siteId)&&a7.location.site&&a7.location.site.name!==bb.options.siteId){if(a4.isContainer){a6=b("documentlibrary?path="+encodeURIComponent(a7.location.path),{site:a7.location.site.name})}else{a6=bb.getActionUrls(a7,a7.location.site.name).documentDetailsUrl}}else{if(a4.isContainer){var a9=Alfresco.DocumentList.getRecordSite(a7),bc=bb.options.siteId,a8=a7.location.path;if(bc!==""&&a9!==null&&bc!==a9){a8=bb.currentPath}if(a7.parent.isContainer||a7.node.isContainer){var ba={};ba.path=a8;ba.file=a7.location.file;a6='#" class="filter-change" rel="'+Alfresco.DocumentList.generatePathMarkup(ba)}else{if(a8==="/"){a6='#" class="filter-change" rel="'+Alfresco.DocumentList.generateFilterMarkup({filterId:"path",filterData:aK(a8,"")})}else{a6="#"}}}else{var a5=bb.getActionUrls(a7);if(a4.isLink&&a4.linkedNode.isContainer){a6=a5.folderDetailsUrl}else{a6=a5.documentDetailsUrl}}}return'<a href="'+a6+'">'};Alfresco.DocumentList.getRecordSite=function aC(a6){var a5=a6.location.repoPath,a8="/Sites/",a4="/documentLibrary",a7=a5.indexOf(a4);if(a5.startsWith(a8)&&a7>-1&&a7==a5.indexOf("/",a8.length)){return a5.substring(a8.length,a7)}return null};Alfresco.DocumentList.generateThumbnailUrl=function ae(a4,a7){var a6=a4.jsNode,a5=a6.isLink?a6.linkedNode.nodeRef:a6.nodeRef;if(a6.isLink&&!a5){return""}if(a7==null){a7="doclib"}return Alfresco.util.generateThumbnailUrl(a6,a7)};Alfresco.DocumentList.generateFavourite=function aL(a6,a4){var a7=a4.jsNode,a8="favourite."+(a7.isContainer?"folder.":"document."),a5="";if(a4.isFavourite){a5='<a href="#" class="favourite-action enabled" title="'+a6.msg(a8+"remove.tip")+'" tabindex="0"></a>'}else{a5='<a href="#" class="favourite-action" title="'+a6.msg(a8+"add.tip")+'" tabindex="0">'+a6.msg(a8+"add.label")+"</a>"}return a5};Alfresco.DocumentList.generateLikes=function q(a7,a4){var a8=a4.node,a5=a4.likes,a9="like."+(a8.isContainer?"folder.":"document."),a6="";if(a5.isLiked){a6='<a href="#" class="like-action enabled" title="'+a7.msg(a9+"remove.tip")+'" tabindex="0"></a>'}else{a6='<a href="#" class="like-action" title="'+a7.msg(a9+"add.tip")+'" tabindex="0">'+a7.msg(a9+"add.label")+"</a>"}a6+='<span class="likes-count">'+f(a5.totalLikes)+"</span>";return a6};Alfresco.DocumentList.generateComments=function aP(a7,a4){var ba=a4.node,a9=a7.getActionUrls(a4),a5=a9[ba.isContainer?"folderDetailsUrl":"documentDetailsUrl"]+"#comment",bb="comment."+(ba.isContainer?"folder.":"document.");var a8=(ba.properties["fm:commentCount"]!==undefined);var a6='<a href="'+a5+'" class="comment'+(a8?" hasComments":"")+'" title="'+a7.msg(bb+"tip")+'" tabindex="0">'+a7.msg(bb+"label")+"</a>";if(a8){a6+='<span class="comment-count">'+f(ba.properties["fm:commentCount"])+"</span>"}return a6};Alfresco.DocumentList.generateQuickShare=function x(a5,a4){return new Alfresco.QuickShare().setOptions({nodeRef:a4.jsNode.nodeRef,displayName:a4.displayName}).display(a4.jsNode.properties.qshare_sharedId,a4.jsNode.properties.qshare_sharedBy)};Alfresco.DocumentList.generateUserLink=function aS(a5,a4){if(a4.isDeleted===true){return"<span>"+a5.msg("details.user.deleted",f(a4.userName))+"</span>"}return n(a4.userName,YAHOO.lang.trim(a4.firstName+" "+a4.lastName))};YAHOO.lang.augmentObject(Alfresco.DocumentList.prototype,{options:{sortAscending:true,showFolders:false,simpleView:null,viewRendererName:"detailed",viewRendererNames:["simple","detailed","gallery"],viewRenderers:[],usePagination:false,siteId:"",containerId:"documentLibrary",rootNode:null,initialPage:1,pageSize:50,initialFilter:{},loadingMessageDelay:1000,highlightFile:null,previewTooltips:null,insituEditors:null,groupActivitiesAt:5,inlineEditMimetypes:{"text/plain":true,"text/html":true,"text/xml":true},replicationUrlMapping:{},listUpdated:false,repositoryBrowsing:true,useTitle:true,userIsSiteManager:false,actionsSplitAt:3},state:{actionEditOfflineActive:false},currentPath:null,currentPage:null,totalRecords:null,currentFilter:null,fileUpload:null,actions:null,selectedFiles:null,currentActionsMenu:null,hideMoreActionsFn:null,afterDocListUpdate:null,doclistMetadata:null,dynamicControls:null,sortControls:null,dragAndDropAllowed:null,dragAndDropEnabled:null,dragEventRefCount:null,dragFolderHighlight:null,renderers:null,viewRenderers:null,_userCanUpload:false,onReady:function W(){var bh=this;this.dragAndDropEnabled=this.dragAndDropAllowed&&("draggable" in document.createElement("span"))&&YAHOO.env.ua.mobile===null;var bb=false;var a7=1;for(var a9=0,bk=this.options.viewRendererNames.length;a9<bk;a9++){if(this.options.viewRendererNames[a9]===this.options.viewRendererName){bb=true;a7=a9;break}}if(!bb&&this.options.viewRendererNames.length>0){this.options.viewRendererName=this.options.viewRendererNames[0]}this.userPreferredView=this.options.viewRendererName;this._setupMetadataRenderers();this._setupHistoryManagers();if(A.get(this.id+"-doclistBar")){this.widgets.sortAscending=Alfresco.util.createYUIButton(this,"sortAscending-button",this.onSortAscending);if(this.widgets.sortAscending!==null){this.widgets.sortAscending.set("title",this.msg(this.options.sortAscending?"button.sort.descending":"button.sort.ascending"));if(!this.options.sortAscending){A.addClass(this.widgets.sortAscending.get("element"),"sort-descending")}this.sortControls.push(this.widgets.sortAscending)}this.widgets.sortField=Alfresco.util.createYUIButton(this,"sortField-button",this.onSortField,{type:"menu",menu:"sortField-menu",lazyloadmenu:false});if(this.widgets.sortField!==null){this.sortControls.push(this.widgets.sortField);var a5=this.widgets.sortField.getMenu().getItems(),bc;for(bc in a5){if(a5.hasOwnProperty(bc)){if(a5[bc].value===this.options.sortField){this.widgets.sortField.set("label",a5[bc].cfg.getProperty("text")+" "+Alfresco.constants.MENU_ARROW_SYMBOL);break}}}}this.widgets.showFolders=Alfresco.util.createYUIButton(this,"showFolders-button",this.onShowFolders,{type:"checkbox",checked:this.options.showFolders});if(this.widgets.showFolders!==null){this.widgets.showFolders.set("title",this.msg(this.options.showFolders?"button.folders.hide":"button.folders.show"));this.dynamicControls.push(this.widgets.showFolders)}if(A.get(this.id+"-simpleDetailed")){this.widgets.viewRendererSelect=new YAHOO.widget.ButtonGroup(this.id+"-simpleDetailed");if(this.widgets.viewRendererSelect!==null){this.widgets.viewRendererSelect.check(a7);this.widgets.viewRendererSelect.on("checkedButtonChange",this.onViewRendererSelect,this.widgets.viewRendererSelect,this);this.dynamicControls.push(this.widgets.viewRendererSelect)}}this.widgets.fileSelect=Alfresco.util.createYUIButton(this,"fileSelect-button",this.onFileSelect,{type:"menu",menu:"fileSelect-menu"});if(this.widgets.fileSelect!==null){this.dynamicControls.push(this.widgets.fileSelect)}if(A.get(this.id+"-options-button")){this.widgets.optionsMenu=Alfresco.util.createYUIButton(this,"options-button",this.onOptionSelect,{type:"menu",menu:"options-menu"});if(this.widgets.optionsMenu!==null){this.dynamicControls.push(this.widgets.optionsMenu)}}}this.services.preferences=new Alfresco.service.Preferences();this.services.likes=new Alfresco.service.Ratings(Alfresco.service.Ratings.LIKES);this._setupViewRenderers();this._setupDataSource();this._setupDataTable();var bj=function a6(bp,bo){if(bh.hideMoreActionsFn){bh.hideMoreActionsFn.call(bh)}var bl=YAHOO.Bubbling.getOwnerByTagName(bo[1].anchor,"div");if(bl!==null){if(typeof bh[bl.id]==="function"){bo[1].stop=true;var bn=bo[1].target;if(typeof bh.viewRenderers[bh.options.viewRendererName]==="object"){bn=bh.viewRenderers[bh.options.viewRendererName].getDataTableRecordIdFromRowElement(bh,bo[1].target)}var bm=bh.widgets.dataTable.getRecord(bn).getData();bh[bl.id].call(bh,bm,bl)}}return true};YAHOO.Bubbling.addDefaultAction("action-link",bj);YAHOO.Bubbling.addDefaultAction("show-more",bj);var bf=function bi(bn,bm){var bl=YAHOO.Bubbling.getOwnerByTagName(bm[1].anchor,"div");if(bl!==null){bh.onLikes.call(bh,bm[1].target.offsetParent,bl)}return true};YAHOO.Bubbling.addDefaultAction("like-action",bf);var be=function a4(bn,bm){var bl=YAHOO.Bubbling.getOwnerByTagName(bm[1].anchor,"div");if(bl!==null){bh.onFavourite.call(bh,bm[1].target.offsetParent,bl)}return true};YAHOO.Bubbling.addDefaultAction("favourite-action",be);var bg=function a8(bn,bm){var bl=bm[1].anchor;if(bl!==null){var bo=bl.rel,bp,bq={};if(bo&&bo!==""){bm[1].stop=true;bp=bo.split("|");bq={filterOwner:window.unescape(bp[0]||""),filterId:window.unescape(bp[1]||""),filterData:window.unescape(bp[2]||""),filterDisplay:window.unescape(bp[3]||"")};Alfresco.logger.debug("DL_fnChangeFilterHandler","changeFilter =>",bq);YAHOO.Bubbling.fire("changeFilter",bq)}}return true};YAHOO.Bubbling.addDefaultAction("filter-change",bg);this.modules.actions=new Alfresco.module.DoclibActions();P.addListener(window,"resize",this._resizeRowContainers,this,true);YAHOO.util.History.onReady(this.onHistoryManagerReady,this,true);try{YAHOO.util.History.initialize("yui-history-field","yui-history-iframe")}catch(bd){Alfresco.logger.error(this.name+": Couldn't initialize HistoryManager.",bd);this.onHistoryManagerReady()}var ba=new Alfresco.widget.FullScreen(this.id);this.fullscreen=ba;YAHOO.util.Event.addListener(A.get(this.id+"-fullscreen-exit-button"),"click",function(bl){ba.toggleFullScreen()});YAHOO.Bubbling.on("fullScreenEnterComplete",function(bm,bl){if(bl[1]&&bl[1].eventGroup==this.id&&(typeof this.viewRenderers[this.options.viewRendererName]==="object")&&this.viewRenderers[this.options.viewRendererName].currentResizeCallback){this.viewRenderers[this.options.viewRendererName].currentResizeCallback()}},this);YAHOO.Bubbling.on("fullScreenExitComplete",function(bm,bl){if(bl[1]&&bl[1].eventGroup==this.id&&(typeof this.viewRenderers[this.options.viewRendererName]==="object")&&this.viewRenderers[this.options.viewRendererName].currentResizeCallback){this.viewRenderers[this.options.viewRendererName].currentResizeCallback()}},this);A.setStyle(this.id+"-options-menu","display","inherit");YAHOO.Bubbling.fire("postDocumentListOnReady",{scope:this,eventGroup:this.id})},_insituCallback:function ao(a7,a5){var bb=a5.jsNode,ba=bb.nodeRef,a9="components/documentlibrary/data",a6="";if(F(this.options.siteId)){a9+="/site/"+encodeURIComponent(this.options.siteId)}else{a6="&libraryRoot="+encodeURIComponent(this.options.rootNode.toString())}Alfresco.util.Ajax.request({url:Alfresco.constants.URL_SERVICECONTEXT+a9+"/node/"+ba.uri+"?filter="+encodeURIComponent(this.currentFilter.filterId)+"&view="+this.actionsView+"&noCache="+new Date().getTime()+a6,successCallback:{fn:function a4(bc){bc.json.item.jsNode=new Alfresco.util.Node(bc.json.item.node);YAHOO.Bubbling.fire(bb.isContainer?"folderRenamed":"fileRenamed",{file:bc.json.item});return false},scope:this},failureCallback:{fn:function a8(bc){},scope:this}})},fnRenderCellSelected:function aB(){var a4=this;return function a5(a7,a6,a8,a9){if(typeof a4.viewRenderers[a4.options.viewRendererName]==="object"){a4.viewRenderers[a4.options.viewRendererName].renderCellSelected(a4,a7,a6,a8,a9)}}},fnRenderCellStatus:function R(){var a4=this;return function a5(a7,a6,a8,a9){if(typeof a4.viewRenderers[a4.options.viewRendererName]==="object"){a4.viewRenderers[a4.options.viewRendererName].renderCellStatus(a4,a7,a6,a8,a9)}}},fnRenderCellThumbnail:function aX(){var a4=this;return function a5(a7,a6,a8,a9){if(typeof a4.viewRenderers[a4.options.viewRendererName]==="object"){a4.viewRenderers[a4.options.viewRendererName].renderCellThumbnail(a4,a7,a6,a8,a9)}}},fnRenderCellDescription:function aT(){var a4=this;return function a5(a7,a6,a8,a9){if(typeof a4.viewRenderers[a4.options.viewRendererName]==="object"){a4.viewRenderers[a4.options.viewRendererName].renderCellDescription(a4,a7,a6,a8,a9)}}},fnRenderCellActions:function aY(){var a5=this;return function a4(a7,a6,a8,a9){if(typeof a5.viewRenderers[a5.options.viewRendererName]==="object"){a5.viewRenderers[a5.options.viewRendererName].renderCellActions(a5,a7,a6,a8,a9)}}},renderProperty:function(a5){if(YAHOO.lang.isString(a5)){return f(a5)}else{if(YAHOO.lang.isArray(a5)){var a4=this.renderProperty;return a5.reduce(function(a6,a7){return a4(a6)+", "+a4(a7)})}else{if(YAHOO.lang.isBoolean(a5)){return a5}else{if(YAHOO.lang.isNumber(a5)){return a5}else{if(YAHOO.lang.isObject(a5)){if(a5.hasOwnProperty("iso8601")){return O(a5.iso8601)}else{if(a5.hasOwnProperty("userName")&&a5.hasOwnProperty("displayName")){return Alfresco.util.userProfileLink(a5.userName,a5.displayName)}else{if(a5.hasOwnProperty("displayName")){return f(a5.displayName||"")}else{if(a5.hasOwnProperty("title")){return f(a5.title||"")}else{if(a5.hasOwnProperty("name")){return f(a5.name||"")}}}}}}}}}}return""},onRegisterRenderer:function S(a5,a4){var a6=a4[1];if(a6&&F(a6.propertyName)&&F(a6.renderer)){this.registerRenderer(a6.propertyName,a6.renderer)}else{Alfresco.logger.error("DL_onRegisterRenderer: Custom renderer registion invalid: "+a6)}},onRegisterViewRenderer:function m(a5,a4){var a6=a4[1];if(a6&&F(a6.renderer)){this.registerViewRenderer(a6.renderer)}else{Alfresco.logger.error("DL_onRegisterViewRenderer: Custom view renderer registion invalid: "+a6)}},registerRenderer:function aI(a4,a5){if(F(a4)&&F(a5)){this.renderers[a4]=a5;return true}return false},registerViewRenderer:function Q(a4){if(F(a4)){this.viewRenderers[a4.name]=a4;this.viewRenderers[a4.name].setupRenderer(this);return true}return false},_setupMetadataRenderers:function B(){var a4={};if(this.options.suppressComponent){a4=JSON.parse(this.options.suppressComponent)}this.registerRenderer("i18nLabel",function(a5,a6){return a6.replace(/:\s$/,"")});this.registerRenderer("lockBanner",function(a5,a7){var a9=a5.jsNode.properties,bc=a9.lockOwner||a9.workingCopyOwner,a6=Alfresco.DocumentList.generateUserLink(this,bc),bb=a5.jsNode.isContainer,ba="details.banner.",a8="";if(bb){ba+="folder."}if(a5.workingCopy&&bc.userName===Alfresco.constants.USERNAME){a8=this.msg(ba+(a5.workingCopy.isWorkingCopy?"editing":"lock-owner"))}else{if(bc.userName===Alfresco.constants.USERNAME){a8=this.msg(ba+"lock-owner")}else{a8=this.msg(ba+"locked",a6)}}return a8});this.registerRenderer("syncFailed",function(a5,a6){return'<span class="banner-more-info-link">'+this.msg("details.banner.more-info")+"</span>"+this.msg("details.banner.sync-failed")});this.registerRenderer("syncTransientError",function(a5,a6){return'<span class="banner-more-info-link">'+this.msg("details.banner.more-info")+"</span>"+this.msg("details.banner.sync-transient-error")});this.registerRenderer("date",function(a5,a6){var bb=a5.jsNode,a9=bb.properties,a8="";var a7=Alfresco.util.isSuppressed(a5.node,a4.date.browse.folder);if(!a7){var ba="modified",bc=a9.modified.iso8601;if(a5.workingCopy&&a5.workingCopy.isWorkingCopy){ba="editing-started"}else{if(bc===a9.created.iso8601){ba="created"}}a8='<span class="item">'+a6+this.msg("details."+ba+"-by",ac(bc),Alfresco.DocumentList.generateUserLink(this,a9.modifier))+"</span>"}return a8});this.registerRenderer("size",function(a5,a6){var a9=a5.jsNode,a8=a9.properties,a7="";if(!a9.isContainer&&!a9.isLink){a7+='<span class="item">'+a6+Alfresco.util.formatFileSize(a9.size)+"</span>"}return a7});this.registerRenderer("name",function(a5,a6){var a9=a5.jsNode,a8=a9.properties,a7="";if(a9.hasPermission("Write")&&!a9.isLocked&&!a9.hasAspect("cm:workingcopy")){this.insituEditors.push({context:"___"+a5._filenameId,params:{type:"textBox",nodeRef:a9.nodeRef.toString(),name:"prop_cm_name",value:a5.fileName,fnSelect:function ba(bc,bd){var bb=bd.lastIndexOf(Alfresco.util.getFileExtension(bd))-1;if(bb>0){Alfresco.util.selectText(bc,0,bb)}else{bc.select()}},validations:[{type:Alfresco.forms.validation.length,args:{min:1,max:255,crop:true},when:"keyup",message:this.msg("validation-hint.length.min.max",1,255)},{type:Alfresco.forms.validation.nodeName,when:"keyup",message:this.msg("validation-hint.nodeName")}],title:this.msg("tip.insitu-rename"),errorMessage:this.msg("message.insitu-edit.name.failure")},callback:{fn:this._insituCallback,scope:this,obj:a5}})}a7+='<span id="___'+a5._filenameId+'">'+Alfresco.DocumentList.generateFileFolderLinkMarkup(this,a5);a7+=f(a5.displayName)+"</a></span>";return a7});this.registerRenderer("version",function(a5,a6){var a9=a5.jsNode,a8=a9.properties,a7="";if(!a9.isContainer&&!a9.isLink){a7+='<span class="item">'+a6+a5.version+"</span>"}return a7});this.registerRenderer("description",function(a5,a6){var a9=a5.jsNode,a8=a9.properties,ba=Alfresco.util.generateDomId(),a7='<span id="'+ba+'" class="faded">'+a6+this.msg("details.description.none")+"</span>";if(a8.description&&a8.description!==""){a7='<span id="'+ba+'" class="item">'+a6+al(f(a8.description))+"</span>"}return a7});this.registerRenderer("mimetype",function(a5,a7){var a9=a5.jsNode,a8="",a6="";if(!a9.isContainer&&!a9.isLink){if(typeof a9.mimetypeDisplayName!=="undefined"){a6=a9.mimetypeDisplayName}else{a6=this.msg("label.mimetype.unknown")}a8+='<span class="item">'+a7+a6+"</span>"}return a8});this.registerRenderer("tags",function(ba,bd){var a6=ba.jsNode,bb=a6.properties,a5=Alfresco.util.generateDomId(),a9="";var bc=Alfresco.util.isSuppressed(ba.node,a4.tags.browse.folder);if(!bc){var bf=a6.tags,be;if(a6.hasAspect("cm:taggable")&&bf.length>0){for(var a8=0,a7=bf.length;a8<a7;a8++){be=f(bf[a8]);a9+='<span class="tag" style="display: inline-block"><a href="#" class="tag-link" rel="'+be+'">'+be+"</a></span>"}}else{a9+='<span class="faded">'+bd+this.msg("details.tags.none")+"</span>"}if(a6.hasPermission("Write")&&!a6.isLocked){this.insituEditors.push({context:a5,params:{type:"tagEditor",nodeRef:a6.nodeRef.toString(),name:"prop_cm_taggable",value:ba.node.properties["cm:taggable"],validations:[{type:Alfresco.forms.validation.nodeName,when:"keyup",message:this.msg("validation-hint.nodeName")},{type:Alfresco.forms.validation.length,args:{min:1,max:255,crop:true,ignoreEmpty:true},when:"keyup",message:this.msg("validation-hint.length.min.max",1,255)}],title:this.msg("tip.insitu-tag"),errorMessage:this.msg("message.insitu-edit.tag.failure")},callback:{fn:this._insituCallback,scope:this,obj:ba}})}return'<span id="'+a5+'" class="item">'+bd+a9+"</span>"}return""});this.registerRenderer("categories",function(bb,bd){var a5=bb.jsNode,bc=a5.properties,a9="";if(a5.hasAspect("cm:generalclassifiable")){var ba=a5.categories,a6;a9+='<span class="category-item item">&nbsp;</span><span class="item">'+bd;if(ba.length>0){for(var a8=0,a7=ba.length;a8<a7;a8++){a6=ba[a8];a9+='<span class="category"><a href="#" class="filter-change" rel="'+Alfresco.DocumentList.generateCategoryMarkup(a6)+'">'+f(a6[0])+"</a></span>"+(a7-a8>1?", ":"")}}else{a9+='<span class="faded">'+bd+this.msg("details.categories.none")+"</span>"}a9+="</span>"}return a9});this.registerRenderer("social",function(a5){var a8=a5.jsNode,a6="";var a7=Alfresco.util.isSuppressed(a5.node,a4.social.browse.folder);if(!a7){a6+='<span class="item item-social">'+Alfresco.DocumentList.generateFavourite(this,a5)+"</span>";a6+='<span class="item item-social item-separator">'+Alfresco.DocumentList.generateLikes(this,a5)+"</span>";if(a8.permissions.user.CreateChildren){a6+='<span class="item item-social item-separator">'+Alfresco.DocumentList.generateComments(this,a5)+"</span>"}if(!a5.node.isContainer&&Alfresco.constants.QUICKSHARE_URL){a6+='<span class="item item-separator">'+Alfresco.DocumentList.generateQuickShare(this,a5)+"</span>"}}return a6})},_setupViewRenderers:function V(){for(var a6=0;a6<this.options.viewRenderers.length;a6++){var a7=this.options.viewRenderers[a6].widget;if(a7!=null){var a5=a7.split(".");var a8=window;for(var a4=0;a4<a5.length;a4++){a8=a8[a5[a4]]}if(typeof a8==="function"){this.registerViewRenderer(new a8(this.options.viewRenderers[a6].id,this,this.options.commonComponentStyle,this.options.viewRenderers[a6].jsonConfig))}}}YAHOO.Bubbling.fire("postSetupViewRenderers",{scope:this,eventGroup:this.id})},_setupHistoryManagers:function ax(){var a7=YAHOO.util.History.getBookmarkedState("filter");a7=a7||"path|/";try{while(a7!==(a7=decodeURIComponent(a7.replace(/%25/g,"%2525")))){}}catch(ba){}var a5=function bc(bd){var be=bd.split("|"),bf={filterId:window.unescape(be[0]||"")};if(typeof be[1]!=="undefined"){bf.filterData=window.unescape(be[1])}if(typeof be[2]!=="undefined"){bf.filterDisplay=window.unescape(be[2])}bf.filterOwner=Alfresco.util.FilterManager.getOwner(bf.filterId);return bf};this.options.initialFilter=a5(a7);YAHOO.util.History.register("filter",a7,function a4(be){Alfresco.logger.debug("HistoryManager: filter changed:"+be);var bd=YAHOO.util.History.getBookmarkedState("page")||"1";while(bd!==(bd=decodeURIComponent(bd))){}var bf=parseInt(bd||this.options.initialPage,10);if(this.currentPage!=bf){this.currentPage=bf}this._updateDocList.call(this,{filter:a5(be),page:this.currentPage})},null,this);var a6=function a8(be,bd){bd.widgets.paginator.setState(be);YAHOO.util.History.navigate("page",String(be.page))};if(this.options.usePagination){var bb=YAHOO.util.History.getBookmarkedState("page")||"1";while(bb!==(bb=decodeURIComponent(bb))){}this.currentPage=parseInt(bb||this.options.initialPage,10);YAHOO.util.History.register("page",bb,function a9(bd){Alfresco.logger.debug("HistoryManager: page changed:"+bd);if(this.currentPage!=bd){this.selectedFiles={};this._updateDocList.call(this,{page:bd})}else{Alfresco.logger.debug("...page changed event ignored.")}},null,this);this.widgets.paginator=new YAHOO.widget.Paginator({containers:[this.id+"-paginator",this.id+"-paginatorBottom"],rowsPerPage:this.options.pageSize,initialPage:this.currentPage,template:this.msg("pagination.template"),pageReportTemplate:this.msg("pagination.template.page-report"),previousPageLinkLabel:this.msg("pagination.previousPageLinkLabel"),nextPageLinkLabel:this.msg("pagination.nextPageLinkLabel")});this.widgets.paginator.subscribe("changeRequest",a6,this);A.setStyle(this.id+"-doclistBarBottom","display","block")}},_setupDataSource:function ad(){var a5=this;this.widgets.dataSource=new YAHOO.util.DataSource(this.dataSourceUrl,{responseType:YAHOO.util.DataSource.TYPE_JSON,responseSchema:{resultsList:"items",metaFields:{paginationRecordOffset:"startIndex",totalRecords:"totalRecords",totalRecordsUpper:"totalRecordsUpper"}}});this.widgets.dataSource.doBeforeCallback=function a4(a8,a6,a9){a5.doclistMetadata=a6.metadata;YAHOO.Bubbling.fire("doclistMetadata",{metadata:a5.doclistMetadata});var a7=null;if(a5.doclistMetadata.parent){a7=a5.doclistMetadata.parent.permissions;if(a7&&a7.user){YAHOO.Bubbling.fire("userAccess",{userAccess:a7.user})}}if(typeof a5.viewRenderers[a5.options.viewRendererName]==="object"){a5.viewRenderers[a5.options.viewRendererName].renderEmptyDataSourceHtml(a5,a7)}return a9}},_setupDataTable:function aU(){var bd=this;var a5=A.get("alf-filters"),a6=(a5?parseInt(a5.style.width,10):160)+390;var a7=[{key:"nodeRef",label:"Select",sortable:false,formatter:this.fnRenderCellSelected(),width:16},{key:"status",label:"Status",sortable:false,formatter:this.fnRenderCellStatus(),width:16},{key:"thumbnail",label:"Preview",sortable:false,formatter:this.fnRenderCellThumbnail(),width:100},{key:"fileName",label:"Description",sortable:false,formatter:this.fnRenderCellDescription(),width:(A.getViewportWidth()-a6)},{key:"actions",label:"Actions",sortable:false,formatter:this.fnRenderCellActions(),width:200}];this.widgets.dataTable=new YAHOO.widget.DataTable(this.id+"-documents",a7,this.widgets.dataSource,{renderLoopSize:this.options.usePagination?16:Alfresco.util.RENDERLOOPSIZE,initialLoad:false,dynamicData:true,MSG_EMPTY:this.msg("message.loading")});var bc=A.getElementsByClassName("yui-dt-empty");if(bc.length>0){bc[0].colSpan=100}this.widgets.dataTable.handleDataReturnPayload=function a9(bf,be,bg){bd.totalRecords=be.meta.totalRecords;bd.totalRecordsUpper=be.meta.totalRecordsUpper;return be.meta};this._setDefaultDataTableErrors(this.widgets.dataTable);this.widgets.dataTable.subscribe("tableMsgShowEvent",function(bj){this._elMsgTbody.parentNode.style.width="";if(bj.html&&bj.html.indexOf("docListInstructions")!==-1){var bm=Alfresco.util.ComponentManager.findFirst("Alfresco.DocListToolbar");if(bm!==null){var bk=A.get(bd.id+"-standard-upload-link-template-instance");if(bk!==null){var bn=A.getChildren(bk);P.addListener(bn[0],"click",bm.onFileUpload,bm,true);P.addListener(A.getFirstChild(bn[1]),"click",bm.onFileUpload,bm,true)}var bi=A.get(bd.id+"-new-folder-link-template-instance");if(bi!==null){var bl=A.getChildren(bi);P.addListener(bl[0],"click",bm.onNewFolder,bm,true);P.addListener(A.getFirstChild(bl[1]),"click",bm.onNewFolder,bm,true)}}var be=A.get(bd.id+"-show-folders-template-instance");if(be!==null){var bg=function bf(){var bo=A.getElementsByClassName("showFolders")[0];bd.options.showFolders=true;bo.innerHTML=this.msg("button.folders.hide");A.replaceClass(bo,"showFolders","hideFolders");bd.services.preferences.set(Z,bd.options.showFolders);YAHOO.Bubbling.fire("metadataRefresh")};var bh=A.getChildren(be);P.addListener(bh[0],"click",bg,bd,true);P.addListener(bh[1],"click",bg,bd,true)}}});this.widgets.dataTable.sortColumn=function(bj,bh){var be=this.getColumnSortDir(bj);var bk=this.get("sortedBy")||{};var bf=(bk.key===bj.key)?true:false;var bg=this.getState();bg.sortedBy={key:bj.key,dir:be};this.set("sortedBy",bg.sortedBy);var bi="ascending";if(be!="yui-dt-asc"){bi="descending"}bd.onSortFieldEvent(bj.field,bi)};this.widgets.dataTable.doBeforeLoadData=function a4(bg,bi,bk){if(bi.error){try{var be=YAHOO.lang.JSON.parse(bi.responseText);bd.widgets.dataTable.set("MSG_ERROR",be.message)}catch(bj){bd._setDefaultDataTableErrors(bd.widgets.dataTable)}}else{if(bi.results.length===0){A.setStyle(bd.widgets.dataTable._elThead,"display","none");this.fireEvent("renderEvent",{type:"renderEvent"})}else{for(var bf=0,bh=bi.results.length;bf<bh;bf++){bi.results[bf].jsNode=new Alfresco.util.Node(bi.results[bf].node)}}}return true};this.widgets.dataTable.subscribe("checkboxClickEvent",function ba(be){var bf=be.target.value;this.selectedFiles[bf]=be.target.checked;YAHOO.Bubbling.fire("selectedFilesChanged")},this,true);this.widgets.dataTable.subscribe("renderEvent",function bb(){Alfresco.logger.debug("DataTable renderEvent");var bk=Alfresco.util.ComponentManager.findFirst("Alfresco.DocListToolbar");if(bk&&bk.isVirtualFolder()){A.addClass(this.id+"-new-folder-link-template-instance","hidden")}if(0<YAHOO.env.ua.ie&&YAHOO.env.ua.ie<7){var bf=this.widgets.dataTable.getTableEl().parentNode;bf.className=bf.className}if(this.widgets.paginator){Alfresco.logger.debug("Setting paginator state: page="+this.currentPage+", totalRecords="+this.totalRecords);this.widgets.paginator.setState({page:this.currentPage,totalRecords:this.totalRecords});if(this.totalRecordsUpper){this.widgets.paginator.set("pageReportTemplate",this.msg("pagination.template.page-report.more"))}else{this.widgets.paginator.set("pageReportTemplate",this.msg("pagination.template.page-report"))}this.widgets.paginator.render()}if(this.options.highlightFile){YAHOO.Bubbling.fire("highlightFile",{fileName:window.unescape(this.options.highlightFile)})}else{if(this.listUpdated){var bj=A.getY(this.id+"-documents"),be=YAHOO.env.ua.ie>0?((document.compatMode&&document.compatMode!=="BackCompat")?document.documentElement:document.body).scrollTop:window.scrollY;if(be>bj){window.scrollTo(0,bj)}}}var bi,bh;for(bi=0,bh=this.afterDocListUpdate.length;bi<bh;bi++){this.afterDocListUpdate[bi].call(this)}this.afterDocListUpdate=[];if(typeof this.widgets.previewTooltip!=="undefined"){this.widgets.previewTooltip.cfg.setProperty("context",this.previewTooltips)}var bg;for(bi=0,bh=this.insituEditors.length;bi<bh;bi++){bg=this.insituEditors[bi];Alfresco.util.createInsituEditor(bg.context,bg.params,bg.callback)}this.widgets.dataTable.set("renderLoopSize",this.options.usePagination?16:Alfresco.util.RENDERLOOPSIZE)},this,true);this.widgets.dataTable.subscribe("rowMouseoverEvent",this.onEventHighlightRow,this,true);this.widgets.dataTable.subscribe("rowMouseoutEvent",this.onEventUnhighlightRow,this,true);P.delegate(this.id,"click",function a8(bg,bi){var bh=bi.getAttribute("data-action"),bj=bd.widgets.dataTable.getRecord(bi),be;if(bj==null){var bk=bd.currentActionsMenu.id;var bf=bd.widgets.dataTable.getRecordSet()._records;for(i=0;i<bf.length;i++){if(bk.indexOf(bf[i]._sId)>0){bj=bd.widgets.dataTable.getRecord(bf[i]._sId);bi=bj._sId}}}if(bj!=null){be=bj.getData()}if(YAHOO.lang.isFunction(bd[bh])){bd[bh].call(bd,be,bi)}else{if(YAHOO.lang.isFunction(window[bh])){window[bh](be,bi)}}},"a.indicator-action");if(this.dragAndDropEnabled){P.addListener(document.body,"dragenter",this._swallowDragEnter,this,true);P.addListener(document.body,"dragover",this._swallowDragOver,this,true);P.addListener(document.body,"drop",this._swallowDragDrop,this,true);P.addListener(document.body,"dragstart",this._swallowDragStart,this,true)}},_removeDragAndDrop:function au(){if(this.dragAndDropEnabled){try{var a5=A.get(this.id+"-dl-body");P.removeListener(a5,"dragenter");P.removeListener(a5,"dragover");P.removeListener(a5,"dragleave");P.removeListener(a5,"drop")}catch(a4){Alfresco.logger.error("_removeDragAndDrop: The following exception occurred: ",a4)}}},_addDragAndDrop:function H(){if(this._userCanUpload&&this.dragAndDropEnabled){try{var a5=A.get(this.id+"-dl-body");P.addListener(a5,"dragenter",this.onDocumentListDragEnter,this,true);P.addListener(a5,"dragover",this.onDocumentListDragOver,this,true);P.addListener(a5,"dragleave",this.onDocumentListDragLeave,this,true);P.addListener(a5,"drop",this.onDocumentListDrop,this,true)}catch(a4){Alfresco.logger.error("_addDragAndDrop: The following exception occurred: ",a4)}}},_swallowDragStart:function r(a4){a4.stopPropagation();a4.preventDefault()},_swallowDragEnter:function s(a4){a4.stopPropagation();a4.preventDefault()},_swallowDragOver:function af(a4){a4.dataTransfer.dropEffect="none";a4.stopPropagation();a4.preventDefault()},_swallowDrop:function az(a4){a4.stopPropagation();a4.preventDefault()},onDocumentListDragEnter:function ap(a9){var a5=a9.target,a7=this.widgets.dataTable.getRecord(a5),a4=this.widgets.dataTable.getColumn(a5),a8=this.widgets.dataTable.getContainerEl(),a6;if(a7&&a4&&(a5.tagName=="IMG"||a5.className=="droppable")&&a4.getKey()=="thumbnail"){a6=a7.getData("jsNode");if(a6&&a6.isContainer){this.dragFolderHighlight=A.getAncestorByClassName(a5,"folder");A.addClass(this.dragFolderHighlight,"dndFolderHighlight");A.removeClass(a8,"dndDocListHighlight")}}else{this.dragEventRefCount=Math.min(++this.dragEventRefCount,2);A.addClass(a8,"dndDocListHighlight");if(this.dragFolderHighlight){A.removeClass(this.dragFolderHighlight,"dndFolderHighlight");this.dragFolderHighlight=null}}a9.stopPropagation();a9.preventDefault()},onDocumentListDragOver:function l(a4){a4.dataTransfer.dropEffect=Math.floor(YAHOO.env.ua.gecko)===1?"move":"copy";a4.stopPropagation();a4.preventDefault()},onDocumentListDragLeave:function a0(a8){var a5=a8.target,a6=this.widgets.dataTable.getRecord(a5),a7=this.widgets.dataTable.getColumn(a5),a4=a6?a6.getData():null;if(a6&&a7&&(a5.tagName=="IMG"||a5.className=="droppable")&&a4.node.isContainer&&a7.getKey()=="thumbnail"){}else{if(--this.dragEventRefCount===0){A.removeClass(this.widgets.dataTable.getContainerEl(),"dndDocListHighlight")}}a8.stopPropagation();a8.preventDefault()},onDocumentListDrop:function ah(be){try{if(be.dataTransfer.files!==undefined&&be.dataTransfer.files!==null&&be.dataTransfer.files.length>0){var bb=Alfresco.getDNDUploadProgressInstance();var a5=false;var bf="",a8,a7;a7=be.dataTransfer.files.length;for(a8=0;a8<a7;a8++){if(be.dataTransfer.files[a8].size>0){a5=true}else{bf+='"'+be.dataTransfer.files[a8].fileName+'", '}}if(!a5){bf=bf.substring(0,bf.lastIndexOf(", "));Alfresco.util.PopupManager.displayMessage({text:bb.msg("message.zeroByteFiles",bf)})}if(a5&&bb.uploadMethod===bb.INMEMORY_UPLOAD){var bi=0;a7=be.dataTransfer.files.length;for(a8=0;a8<a7;a8++){bi+=be.dataTransfer.files[a8].size}if(bi>bb.getInMemoryLimit()){a5=false;Alfresco.util.PopupManager.displayPrompt({text:bb.msg("inmemory.uploadsize.exceeded",Alfresco.util.formatFileSize(bb.getInMemoryLimit()))})}}if(a5){var bd=this.currentPath,a4=bd.substring(bd.lastIndexOf("/")+1),bg=this.doclistMetadata.parent?this.doclistMetadata.parent.nodeRef:null;var bj=this.widgets.dataTable.getRecord(be.target);if(bj!==null){var bc=this.widgets.dataTable.getColumn(be.target),ba=bj.getData();if(be.target.tagName=="IMG"||be.target.className=="droppable"){var bh=ba.location;a4=bh.file;bd=aK(bh.path,bh.file);bg=ba.nodeRef}}A.removeClass(this.widgets.dataTable.getTrEl(be.target),"dndFolderHighlight");A.removeClass(this.widgets.dataTable.getContainerEl(),"dndDocListHighlight");var a9={files:be.dataTransfer.files,uploadDirectoryName:a4,filter:[],mode:bb.MODE_MULTI_UPLOAD,thumbnails:"doclib",onFileUploadComplete:{fn:this.onFileUploadComplete,scope:this}};if(F(this.options.siteId)){a9.siteId=this.options.siteId;a9.containerId=this.options.containerId;a9.uploadDirectory=bd}else{a9.destination=bg}bb.show(a9)}}else{Alfresco.logger.debug("DL_onDocumentListDrop: A drop event was detected, but no files were present for upload: ",be.dataTransfer)}}catch(a6){Alfresco.logger.error("DL_onDocumentListDrop: The following error occurred when files were dropped onto the Document List: ",a6)}be.stopPropagation();be.preventDefault()},onHistoryManagerReady:function y(){if(this.options.initialFilter.filterId==="path"&&window.location.hash=="#upload"){window.location.hash="";var a4=function a5(){YAHOO.Bubbling.fire("showFileUploadDialog",{tooltip:this.msg("dnd.upload.tooltip")})};this.afterDocListUpdate.push(a4)}Alfresco.logger.debug("DL_onHistoryManagerReady","changeFilter =>",this.options.initialFilter);YAHOO.Bubbling.fire("changeFilter",YAHOO.lang.merge({doclistFirstTimeNav:true},this.options.initialFilter));A.setStyle(this.id+"-dl-body","visibility","visible")},getSelectedFiles:function a3(){var a8=[],a9=this.widgets.dataTable.getRecordSet(),a7,a6,a5,a4;for(a5=0,a4=a9.getLength();a5<a4;a5++){a7=a9.getRecord(a5);a6=a7.getData("node");if(this.selectedFiles[a6.nodeRef]){a8.push(a7.getData())}}return a8},selectFiles:function z(bf){var bg;if(typeof this.viewRenderers[this.options.viewRendererName]==="object"){bg=A.get(this.id+this.viewRenderers[this.options.viewRendererName].parentElementIdSuffix)}var bb=this.widgets.dataTable.getRecordSet(),a6=YAHOO.util.Selector.query('input[type="checkbox"]',bg),ba=a6.length,bh,a8,a7,be;switch(bf){case"selectAll":be=function bc(bi,bj){return true};break;case"selectNone":be=function a9(bi,bj){return false};break;case"selectInvert":be=function a5(bi,bj){return !bj};break;case"selectDocuments":be=function a4(bi,bj){return !(bi.node.isContainer)};break;case"selectFolders":be=function a4(bi,bj){return bi.node.isContainer};break;default:be=function bd(bi,bj){return bj}}for(a7=0;a7<ba;a7++){bh=bb.getRecord(a7);a8=bh.getData();this.selectedFiles[a8.nodeRef]=a6[a7].checked=be(a8,a6[a7].checked)}YAHOO.Bubbling.fire("selectedFilesChanged")},onSortAscending:function Y(a4,a5){this.widgets.dataTable.set("sortedBy",null);this.options.sortAscending=!this.options.sortAscending;this.widgets.sortAscending.set("title",this.msg(this.options.sortAscending?"button.sort.descending":"button.sort.ascending"));if(this.options.sortAscending){A.removeClass(this.widgets.sortAscending.get("element"),"sort-descending")}else{A.addClass(this.widgets.sortAscending.get("element"),"sort-descending")}this.services.preferences.set(aG,this.options.sortAscending);YAHOO.Bubbling.fire("metadataRefresh");if(a4){P.preventDefault(a4)}},onSortEvent:function a2(a4){this.options.sortAscending=(a4!="descending");this.services.preferences.set(aG,this.options.sortAscending);YAHOO.Bubbling.fire("metadataRefresh")},onSortField:function aR(a9,a8,a7){this.widgets.dataTable.set("sortedBy",null);var a4=a8[0],a6=a8[1];if(a6){var a5=this;this.options.sortField=a6.value;this.widgets.sortField.set("label",a6.cfg.getProperty("text")+" "+Alfresco.constants.MENU_ARROW_SYMBOL);this.services.preferences.set(d,this.options.sortField,{successCallback:{fn:function(){var ba=a6.srcElement.getAttribute("title");if(ba==="true"||ba==="false"){a5.options.sortAscending=(ba==="false");a5.onSortAscending()}else{YAHOO.Bubbling.fire("metadataRefresh")}}}})}P.preventDefault(a4)},onSortFieldEvent:function L(a6,a5){this.options.sortField=a6;var a4=this;this.services.preferences.set(d,a6,{successCallback:{fn:function(){if(a5){a4.options.sortAscending=(a5==="ascending");a4.onSortEvent(a5)}else{YAHOO.Bubbling.fire("metadataRefresh")}}}})},onShowFolders:function j(a4,a5){this.options.showFolders=this.widgets.showFolders.get("checked");this.widgets.showFolders.set("title",this.msg(this.options.showFolders?"button.folders.hide":"button.folders.show"));this.services.preferences.set(Z,this.options.showFolders);YAHOO.Bubbling.fire("metadataRefresh");if(a4){P.preventDefault(a4)}},onShowFoldersEvent:function o(a4){this.options.showFolders=a4;this.services.preferences.set(Z,this.options.showFolders);YAHOO.Bubbling.fire("metadataRefresh")},onViewRendererSelect:function a1(a4,a5){this.widgets.dataTable.set("sortedBy",null);this.options.viewRendererName=this.options.viewRendererNames[a4.newValue.index];this.userPreferredView=this.options.viewRendererName;this.services.preferences.set(aa,this.options.viewRendererName);YAHOO.Bubbling.fire("metadataRefresh");if(a4){P.preventDefault(a4)}},onViewRendererSelectEvent:function aE(a4){var a7=false;for(var a6=0;a6<this.options.viewRendererNames.length&&!a7;a6++){a7=(this.options.viewRendererNames[a6]==a4)}if(a7){this.widgets.dataTable.set("sortedBy",null);this.options.viewRendererName=a4;this.userPreferredView=this.options.viewRendererName;this.services.preferences.set(aa,this.options.viewRendererName);for(var a6=0;a6<this.options.viewRenderers.length;a6++){if(this.options.viewRenderers[a6].id==this.options.viewRendererName){var a5=A.getElementsByClassName("setDefaultView");a5[0].innerHTML=this.msg("button.setDefaultView",this.options.viewRenderers[a6].label);break}}YAHOO.Bubbling.fire("metadataRefresh")}},onFileSelect:function c(a8,a7,a6){var a4=a7[0],a5=a7[1];this.selectFiles(Alfresco.util.findEventClass(a5))},onOptionSelect:function aF(a5,bb,bh){var bc=bb[0],bg=bb[1];var a7=Alfresco.util.findEventClass(bg);var a6=bg.element;while((a6!==null)&&((a6.tagName.toLowerCase()!="span")||(a6.className.indexOf("yui")===0))){a6=a6.firstChild}var bd=a6;if(a7=="showFolders"){this.options.showFolders=true;bd.innerHTML=this.msg("button.folders.hide");A.replaceClass(bd,"showFolders","hideFolders");this.services.preferences.set(Z,this.options.showFolders);YAHOO.Bubbling.fire("metadataRefresh")}else{if(a7=="hideFolders"){this.options.showFolders=false;bd.innerHTML=this.msg("button.folders.show");A.replaceClass(bd,"hideFolders","showFolders");this.services.preferences.set(Z,this.options.showFolders);YAHOO.Bubbling.fire("metadataRefresh")}else{if(a7=="showPath"){this.options.hideNavBar=false;bd.innerHTML=this.msg("button.navbar.hide");A.replaceClass(bd,"showPath","hidePath");this.services.preferences.set(E,this.options.hideNavBar);A.setStyle(this.options.associatedToolbar.id+"-navBar","display",this.options.hideNavBar?"none":"block")}else{if(a7=="hidePath"){this.options.hideNavBar=true;bd.innerHTML=this.msg("button.navbar.show");A.replaceClass(bd,"hidePath","showPath");this.services.preferences.set(E,this.options.hideNavBar);A.setStyle(this.options.associatedToolbar.id+"-navBar","display",this.options.hideNavBar?"none":"block")}else{if(a7=="fullWindow"){this.fullscreen.toggleFullScreen(true)}else{if(a7=="fullScreen"){this.fullscreen.toggleFullScreen(false)}else{if(a7=="rss"){window.location=this.options.associatedToolbar._getRssFeedUrl()}else{if(a7=="removeDefaultView"||a7=="setDefaultView"){if(a7=="setDefaultView"){for(var a9=0;a9<this.options.viewRenderers.length;a9++){if(this.options.viewRenderers[a9].id==this.options.viewRendererName){var be=A.getElementsByClassName("removeDefaultView");be[0].innerHTML=this.msg("button.removeDefaultView",this.options.viewRenderers[a9].label);break}}}var bf=this.doclistMetadata.parent.nodeRef;bf=bf.replace(/:\//g,"");var ba=this;var a4={prop_app_defaultViewId:(a7=="removeDefaultView"?"":this.options.viewRendererName)};Alfresco.util.Ajax.jsonRequest({method:"POST",url:Alfresco.constants.PROXY_URI+"api/node/"+bf+"/formprocessor",dataObj:a4,successCallback:{fn:function(){this._updateDocList.call(this)},scope:this},failure:{message:ba.msg("message.save.failure")}})}else{if(a7.indexOf=="view "!=-1){var a8=a7.substring(5);this.onViewRendererSelectEvent(a8)}}}}}}}}}P.preventDefault(bc)},onEventHighlightRow:function ab(a4){if(typeof this.viewRenderers[this.options.viewRendererName]==="object"){this.viewRenderers[this.options.viewRendererName].onEventHighlightRow(this,a4)}},onEventUnhighlightRow:function K(a4){if(typeof this.viewRenderers[this.options.viewRendererName]==="object"){this.viewRenderers[this.options.viewRendererName].onEventUnhighlightRow(this,a4)}},onActionShowMore:function D(a5,a4){if(typeof this.viewRenderers[this.options.viewRendererName]==="object"){this.viewRenderers[this.options.viewRendererName].onActionShowMore(this,a5,a4)}},onActionEditOffline:function U(a6){if(!this.state.actionEditOfflineActive){this.state.actionEditOfflineActive=true;var a7=a6.jsNode.nodeRef,a5=a6.displayName;this.modules.actions.genericAction({success:{event:{name:"metadataRefresh"},callback:{fn:function a8(bb){this.state.actionEditOfflineActive=false;this.options.highlightFile=a5;var ba=function a9(){var bc=false;YAHOO.Bubbling.on("editingCanceled",function(bh,bg){if(bb.config.object.nodeRef==bg[1].record.workingCopy.sourceNodeRef.replace(/:\//g,"")){bc=true}},this);var bf=Alfresco.constants.PROXY_URI+bb.json.results[0].downloadUrl;if(YAHOO.env.ua.ie>6){Alfresco.util.PopupManager.displayPrompt({title:this.msg("message.edit-offline.success",a5),text:this.msg("message.edit-offline.success.ie7"),buttons:[{text:this.msg("button.download"),handler:function be(){window.open(bf,"_blank");this.destroy()},isDefault:true},{text:this.msg("button.close"),handler:function bd(){this.destroy()}}]})}else{Alfresco.util.PopupManager.displayMessage({text:this.msg("message.edit-offline.success",a5)});YAHOO.lang.later(3000,this,function(){if(!bc){window.location=bf}})}};this.afterDocListUpdate.push(ba)},scope:this}},failure:{callback:{fn:function a4(){this.state.actionEditOfflineActive=false},scope:this},message:this.msg("message.edit-offline.failure",a5)},webscript:{method:Alfresco.util.Ajax.POST,name:"checkout/node/{nodeRef}",params:{nodeRef:a7.uri}}})}},_checkIfUpdatedPageIsEmpty:function u(){var a4=(this.currentPage-1)*this.options.pageSize;if(a4>=this.totalRecords){this.widgets.paginator.setPage(1);this.currentPage=1}},_unselectFile:function aW(a5){var a4=a5.action;if(a4&&(a4=="fileCopied"||a4=="fileMoved"||a4=="folderCopied"||a4=="folderMoved")){if(this.selectedFiles[a5.nodeRef]){this.selectedFiles[a5.nodeRef]=false}}},onFileAction:function aD(a5,a4){var a6=a4[1];if(a6){this._unselectFile(a6);if(!a6.multiple){this._checkIfUpdatedPageIsEmpty();this._updateDocList.call(this)}}},onFileRenamed:function M(a5,a4){if(typeof this.viewRenderers[this.options.viewRendererName]==="object"){this.viewRenderers[this.options.viewRendererName].onFileRenamed(this,a5,a4)}},_unselectCopiedFiles:function I(a6){if(a6.action=="filesCopied"&&a6.sourceFilesObj&&a6.sourceFilesObj.nodeRefs){var a7=a6.sourceFilesObj.nodeRefs;for(var a5=0,a4=a7.length;a5<a4;a5++){if(this.selectedFiles[a7[a5]]){this.selectedFiles[a7[a5]]=false}}}},onDocListRefresh:function ag(a5,a4){var a6=a4[1];this._unselectCopiedFiles(a6);if(a6&&(a6.highlightFile!==null)){this.options.highlightFile=a6.highlightFile}this._checkIfUpdatedPageIsEmpty();this._updateDocList.call(this)},onChangeFilter:function J(a6,a5){var a9=a5[1];if((a9!==null)&&(a9.filterId!==null)){var a8=Alfresco.util.cleanBubblingObject(a9),a7=window.escape(a9.filterId)+(typeof a9.filterData!=="undefined"?"|"+window.escape(a9.filterData)+(typeof a9.filterDisplay!=="undefined"?"|"+window.escape(a9.filterDisplay):""):"");Alfresco.logger.debug("DL_onChangeFilter: ",a8);this._removeDragAndDrop();if(a9.filterId==="path"||a9.filterId==="favourites"){this._addDragAndDrop()}this.listUpdated=true;var a4={filter:a7};if(a9.doclistFirstTimeNav||a7===YAHOO.util.History.getCurrentState("filter")){this._updateDocList.call(this,{filter:a8,page:this.currentPage})}else{if(this.options.usePagination){this.currentPage=1;a4.page="1"}Alfresco.logger.debug("DL_onChangeFilter: objNav = ",a4);if(this.options.highlightFile&&a4.filter===YAHOO.util.History.getCurrentState("filter")){YAHOO.Bubbling.fire("highlightFile",{fileName:this.options.highlightFile})}YAHOO.util.History.multiNavigate(a4)}}},onFilterChanged:function w(a5,a4){var a6=a4[1];if((a6!==null)&&(a6.filterId!==null)){a6.filterOwner=a6.filterOwner||Alfresco.util.FilterManager.getOwner(a6.filterId);this.currentFilter=Alfresco.util.cleanBubblingObject(a6);Alfresco.logger.debug("DL_onFilterChanged: ",this.currentFilter)}},onHighlightFile:function ai(a5,a4){if(typeof this.viewRenderers[this.options.viewRendererName]==="object"){this.viewRenderers[this.options.viewRendererName].onHighlightFile(this,a5,a4)}},onDeactivateAllControls:function X(a6,a5){var a4,a7=Alfresco.util.disableYUIButton;for(a4 in this.widgets){if(this.widgets.hasOwnProperty(a4)){a7(this.widgets[a4])}}},onDeactivateDynamicControls:function at(a6,a5){var a4,a7=Alfresco.util.disableYUIButton;for(a4 in this.dynamicControls){if(this.dynamicControls.hasOwnProperty(a4)){a7(this.dynamicControls[a4])}}},onDeactivateSortControls:function aH(a6,a5){var a4,a7=Alfresco.util.disableYUIButton;for(a4 in this.sortControls){if(this.sortControls.hasOwnProperty(a4)){a7(this.sortControls[a4])}}},onActivateSortControls:function g(a6,a5){var a4,a7=Alfresco.util.enableYUIButton;for(a4 in this.sortControls){if(this.sortControls.hasOwnProperty(a4)){a7(this.sortControls[a4])}}},onActivateDynamicControls:function G(a6,a5){var a4,a7=Alfresco.util.enableYUIButton;for(a4 in this.dynamicControls){if(this.dynamicControls.hasOwnProperty(a4)){a7(this.dynamicControls[a4])}}},onLikes:function C(ba){var a7=ba;if(typeof this.viewRenderers[this.options.viewRendererName]==="object"){a7=this.viewRenderers[this.options.viewRendererName].getDataTableRecordIdFromRowElement(this,ba)}var bb=this.widgets.dataTable.getRecord(a7),a8=bb.getData(),a9=a8.jsNode.nodeRef,a5=a8.likes;a5.isLiked=!a5.isLiked;a5.totalLikes+=(a5.isLiked?1:-1);var bc={successCallback:{fn:function a4(bj,bg){var bk=bj.json.data;if(bk){var bi=this._findRecordByParameter(bg,"nodeRef"),bd=bi.getData(),bh=bd.node,be=bd.likes;be.totalLikes=bk.ratingsCount;this.widgets.dataTable.updateRow(bi,bd);if(be.isLiked){var bf={fileName:bd.fileName,nodeRef:bh.nodeRef};if(bh.isContainer){this.modules.actions.postActivity(this.options.siteId,"folder-liked","folder-details",bf)}else{this.modules.actions.postActivity(this.options.siteId,"file-liked","document-details",bf)}}}},scope:this,obj:a9.toString()},failureCallback:{fn:function a6(bh,bf){var bg=this._findRecordByParameter(bf,"nodeRef"),bd=bg.getData(),be=bd.likes;be.isLiked=!be.isLiked;be.totalLikes+=(be.isLiked?1:-1);this.widgets.dataTable.updateRow(bg,bd);Alfresco.util.PopupManager.displayPrompt({text:this.msg("message.save.failure",bd.displayName)})},scope:this,obj:a9.toString()}};if(a5.isLiked){this.services.likes.set(a9,1,bc)}else{this.services.likes.remove(a9,bc)}this.widgets.dataTable.updateRow(bb,a8)},onFavourite:function aA(ba){var a7=ba;if(typeof this.viewRenderers[this.options.viewRendererName]==="object"){a7=this.viewRenderers[this.options.viewRendererName].getDataTableRecordIdFromRowElement(this,ba)}var bb=this.widgets.dataTable.getRecord(a7),a8=bb.getData(),a6=a8.node,a9=a6.nodeRef;a8.isFavourite=!a8.isFavourite;this.widgets.dataTable.updateRow(bb,a8);var a5=a8.isFavourite?"favouriteDocumentOrFolder":"unFavouriteDocumentOrFolder";var bc={failureCallback:{fn:function a4(bh,bd){var bg=this.widgets.dataTable.getRecord(bd),be=bg.getData(),bf=be.node;be.isFavourite=!be.isFavourite;this.widgets.dataTable.updateRow(bg,be);Alfresco.util.PopupManager.displayPrompt({text:this.msg("message.save.failure",be.displayName)})},scope:this,obj:ba}};this.services.preferences[a5].call(this.services.preferences,a6,bc)},onResizerChanged:function aQ(){this._resizeRowContainers()},_resizeRowContainers:function an(a7){if(!YAHOO.lang.isNumber(a7)){var a4=A.get("alf-filters"),a8=(a4?parseInt(a4.style.width,10):160)+390,a7=(A.getViewportWidth()-a8)+"px"}else{a7=(a7-390)+"px"}var a5=YAHOO.util.Selector.query("h3.filename",this.id+"-documents");for(var a6=0;a6<a5.length;a6++){a5[a6].parentNode.style.width=a7}},_setDefaultDataTableErrors:function e(a4){var a5=Alfresco.util.message;a4.set("MSG_EMPTY",a5("message.empty","Alfresco.DocumentList"));a4.set("MSG_ERROR",a5("message.error","Alfresco.DocumentList"))},_updateDefaultViewOptions:function ay(a9){var a7=A.getElementsByClassName("removeDefaultView");var a8=null;if(a7.length>0){a8=a7[0].parentNode.parentNode}var a4=A.getElementsByClassName("setDefaultView");var a6=null;if(a4.length>0){a6=a4[0].parentNode.parentNode}if(this.options.userIsSiteManager||(this.doclistMetadata.parent.properties!=null&&this.doclistMetadata.parent.properties["cm:creator"].userName==Alfresco.constants.USERNAME)){if(this.doclistMetadata.parent.properties!=null&&this.doclistMetadata.parent.properties["app:defaultViewId"]!=null&&this.doclistMetadata.parent.properties["app:defaultViewId"]!=""){for(var a5=0;a5<this.options.viewRenderers.length;a5++){if(this.options.viewRenderers[a5].id==this.doclistMetadata.parent.properties["app:defaultViewId"]){a7[0].innerHTML=this.msg("button.removeDefaultView",this.options.viewRenderers[a5].label);break}}A.removeClass(a8,"hidden");if(this.doclistMetadata.parent.properties["app:defaultViewId"]==this.options.viewRendererName){A.addClass(a6,"hidden")}else{A.removeClass(a6,"hidden")}}else{A.removeClass(a6,"hidden");A.addClass(a8,"hidden")}}else{A.addClass(a6,"hidden");A.addClass(a8,"hidden")}if(a9){if(this.doclistMetadata.parent.properties&&this.doclistMetadata.parent.properties["app:defaultViewId"]!=null&&this.doclistMetadata.parent.properties["app:defaultViewId"]!=""){this.options.viewRendererName=this.doclistMetadata.parent.properties["app:defaultViewId"];A.addClass(a6,"hidden")}else{if(this.userPreferredView!=this.options.viewRendererName){this.options.viewRendererName=this.userPreferredView}}}for(var a5=0;a5<this.options.viewRenderers.length;a5++){if(this.options.viewRenderers[a5].id==this.options.viewRendererName){a4[0].innerHTML=this.msg("button.setDefaultView",this.options.viewRenderers[a5].label);break}}},_updateDocList:function aJ(bh){bh=bh||{};Alfresco.logger.debug("DL__updateDocList: ",bh.filter,bh.page);var bj=YAHOO.lang.merge({doclistFirstTimeNav:false},bh.filter!==undefined?bh.filter:this.currentFilter),a5=bh.page!==undefined?bh.page:this.currentPage,bd=null,a9=null,bf=this,a7={filter:bj,page:a5};var ba=function be(){Alfresco.logger.debug("DL__uDL_fnShowLoadingMessage: slow data webscript detected.");if(a9){bd=Alfresco.util.PopupManager.displayMessage({displayTime:0,text:'<span class="wait">'+f(this.msg("message.loading"))+"</span>",noEscape:true});if(YAHOO.env.ua.ie>0){this.loadingMessageShowing=true}else{bd.showEvent.subscribe(function(){this.loadingMessageShowing=true},this,true)}}};this._setDefaultDataTableErrors(this.widgets.dataTable);this.previewTooltips=[];this.insituEditors=[];this.hideMoreActionsFn=null;this.loadingMessageShowing=false;a9=YAHOO.lang.later(this.options.loadingMessageDelay,this,ba);var bi=function bb(){if(a9){a9.cancel();a9=null}if(bd){if(this.loadingMessageShowing){bd.destroy();bd=null}else{YAHOO.lang.later(100,bf,bi)}}};var bc=function a6(bn,bp,bq){bi();var bk=function bl(){YAHOO.Bubbling.fire("activateDynamicControls");YAHOO.Bubbling.fire("selectedFilesChanged");this.listUpdated=false;if(this.currentFilter.filterId=="recentlyModified"||this.currentFilter.filterId=="recentlyAdded"){YAHOO.Bubbling.fire("deactivateSortControls")}else{YAHOO.Bubbling.fire("activateSortControls")}};this.afterDocListUpdate.push(bk);Alfresco.logger.debug("currentFilter was:",this.currentFilter,"now:",bj);Alfresco.logger.debug("currentPage was ["+this.currentPage+"] now ["+a5+"]");this.currentFilter=bj;this.currentPage=a5;var br=false;if(bj.filterId==="path"){Alfresco.logger.debug("currentPath was ["+this.currentPath+"] now ["+bj.filterData+"]");br=(this.currentPath!=bj.filterData);this.currentPath=bj.filterData}delete bj.doclistFirstTimeNav;YAHOO.Bubbling.fire("filterChanged",bj);this._updateDefaultViewOptions(br);for(var bm=0,bo=this.options.viewRendererNames.length;bm<bo;bm++){if(typeof this.viewRenderers[this.options.viewRendererNames[bm]]==="object"){this.viewRenderers[this.options.viewRendererNames[bm]].destroyView(this,bn,bp,bq)}}if(typeof this.viewRenderers[this.options.viewRendererName]==="object"){this.viewRenderers[this.options.viewRendererName].renderView(this,bn,bp,bq)}else{}};var a4=function a8(bk,bl){bi();this.afterDocListUpdate=[];if(bl.status===401){window.location.reload(true)}else{try{if(bl.status===404){YAHOO.Bubbling.fire("deactivateDynamicControls");YAHOO.Bubbling.fire("deactivateSortControls")}else{YAHOO.Bubbling.fire("deactivateAllControls")}var bo=function bm(br,bq){return function bp(){this.widgets.paginator.setState({totalRecords:0});this.widgets.paginator.render();this.widgets.dataTable.set("MSG_ERROR",br);if(bq===410){this.widgets.dataTable.showTableMessage(br,YAHOO.widget.DataTable.CLASS_DISABLED)}else{this.widgets.dataTable.showTableMessage(br,YAHOO.widget.DataTable.CLASS_ERROR)}}};this.afterDocListUpdate.push(bo(YAHOO.lang.JSON.parse(bl.responseText).message,bl.status));this.widgets.dataTable.initializeTable();this.widgets.dataTable.render();this.listUpdated=false}catch(bn){Alfresco.logger.error(bn);this._setDefaultDataTableErrors(this.widgets.dataTable)}}};if(a7.filter&&a7.filter.filterId==="path"){a7.path=a7.filter.filterData;if(this.currentFilter.filterData!=a7.path){Alfresco.logger.debug("currentFilter.filterData was ["+this.currentFilter.filterData+"] now ["+a7.path+"]");this.currentFilter.filterData=a7.path}}var bg=this._buildDocListParams(a7);Alfresco.logger.debug("DataSource requestParams: ",bg);this.widgets.dataSource.sendRequest(bg,{success:bc,failure:a4,scope:this})},_buildDocListParams:function a(a9){var a6=F(this.options.siteId),a7={path:this.currentPath,type:this.options.showFolders?"all":"documents",site:this.options.siteId,container:this.options.containerId,filter:this.currentFilter};if(this.options.usePagination){a7.page=this.widgets.paginator.getCurrentPage()||this.currentPage;a7.pageSize=this.widgets.paginator.getRowsPerPage()}if(typeof a9==="object"){a7=YAHOO.lang.merge(a7,a9)}var a5=("alfresco://company/shared"==this.options.rootNode);var a4=a6?"site/{site}/{container}":a5?"node/alfresco/company/shared":"node/alfresco/user/home",a8=YAHOO.lang.substitute("{type}/"+a4+(a7.filter.filterId==="path"?"{path}":""),{type:encodeURIComponent(a7.type),site:encodeURIComponent(a7.site),container:encodeURIComponent(a7.container),path:aK("/",Alfresco.util.encodeURIPath(a7.path))});a8+="?filter="+encodeURIComponent(a7.filter.filterId);if(a7.filter.filterData&&a7.filter.filterId!=="path"){a8+="&filterData="+encodeURIComponent(a7.filter.filterData)}if(this.options.usePagination){a8+="&size="+a7.pageSize+"&pos="+a7.page}a8+="&sortAsc="+this.options.sortAscending+"&sortField="+encodeURIComponent(this.options.sortField);if(!a6){a8+="&libraryRoot="+encodeURIComponent(this.options.rootNode.toString())}a8+="&view="+this.actionsView+"&noCache="+new Date().getTime();return a8},_findRecordByParameter:function aM(ba,a9){var a8=this.widgets.dataTable.getRecordSet(),a7,a4,a6,a5;for(a6=0,a5=a8.getLength();a6<a5;a6++){a7=a8.getRecord(a6);a4=a7.getData();if(a4[a9]===ba||(a4.node&&a4.node[a9]===ba)){return a7}}return null}},true)})();